<!-- #include file="../../../system/lib/form.inc"  --><html xmlns="http://www.w3.org/1999/xhtml" ><head >    <title>Subcontract Request</title></head><%  ESysLib.SetUser(Session("APP_DBUSER"))%><script>var flag='search';//------------------------------------------------------------------function BodyInit(){	System.Translate(document);	txtAdvancepayment.text="of contract price";	txtPerformanceGuaranty.text="of contract price";	txtPaymentTerm.text="progress payment";	txtRetention.text="of contract price"; 	txtDefectWarrantyPeriod.text="after the date issuing taking over certificate"; 	txtLiquidatedDamagesForDelay.text="of the contract price for each day of delay";	BindingDataList();	MerGrid();	dso_get_exrate.Call();	//dso_CheckExitData.Call();}   //------------------------------------------------------------------function BindingDataList(){    	/*var tmp_pk='<%=Request.QueryString("p_pk") %>';	if(tmp_pk !="")	{*/		txtTecps_Orderingconttype_pk.text = '<%=Request.QueryString("p_pk") %>';		//}	var p_code = '<%=Request.QueryString("p_code") %>';	txtServiceType.text = '<%=Request.QueryString("p_service_type") %>';	txtNatureOfWork.text = '<%=Request.QueryString("p_nuture_of_w") %>';	txproject_Pk.text = '<%=Request.QueryString("p_project_pk") %>';	txproject_Cd.text = '<%=Request.QueryString("p_project_code")%>';	txtxproject_Nm.text  = '<%=Request.QueryString("p_project_name")%>';	lstccy.text = '<%=Request.QueryString("p_currency")%>';//currency of form main	txtbudgetB.text = '<%=Request.QueryString("p_BCWS_adj")%>';	txtTecps_Orderingconttype_pk_tmp.text=txtTecps_Orderingconttype_pk.text;    txtRedNo.text=txproject_Cd.text+"-"+p_code;		var data_contract_Method = "<%=ESysLib.SetGridColumnDataSQL("SELECT CODE, B.CODE_NM FROM TAC_COMMCODE_MASTER A, TAC_COMMCODE_DETAIL B WHERE A.PK = B.TAC_COMMCODE_MASTER_PK AND A.ID     = 'TPS0044' AND A.DEL_IF = 0 AND B.DEL_IF = 0 AND B.USE_YN ='Y' ORDER BY CODE, B.CODE_NM" )%>"; 	  GrdContractMethod.SetComboFormat(2,data_contract_Method); //contract_Method	var	data = "<%=ESysLib.SetListDataFUNC("SELECT SF_A_GET_DEFAULT('ACBG0040') FROM DUAL")%>";	var arr  = data.split("|");	txtbookccy.SetDataText(arr[1]);	var ls_ccy= "<%=ESysLib.SetListDataFUNC("SELECT F_COMMONCODE('ACAB0110','03','') FROM DUAL")%>";	txtccy.SetDataText(ls_ccy);		//alert(lstccy.text);		}//---------------------------------------------------------------------function OnNew(obj) {	if(obj=='Master')	{		   txproject_Cd_tmp.text=txproject_Cd.text; 		   txtxproject_Nm_tmp.text=txtxproject_Nm.text;		   txproject_Pk_tmp.text=txproject_Pk.text; 		   txtServiceType_tmp.text=txtServiceType.text; 		   txtRedNo_tmp.text=txtRedNo.text; 		   txtTecps_Orderingconttype_pk_tmp.text=txtTecps_Orderingconttype_pk.text;			   txtbudgetB_tmp.text=txtbudgetB.text;		   txtNatureOfWork_tmp.text=txtNatureOfWork.text;			   if(GrdNature.rows < 3)		   {			   GrdNature.AddRow();			   dso_upd_master.StatusInsert();			   txproject_Cd.text=txproject_Cd_tmp.text; 			   txtxproject_Nm.text=txtxproject_Nm_tmp.text;			   txproject_Pk.text=txproject_Pk_tmp.text; 			   txtServiceType.text=txtServiceType_tmp.text; 			   txtRedNo.text=txtRedNo_tmp.text;			   txtTecps_Orderingconttype_pk.text=txtTecps_Orderingconttype_pk_tmp.text;			   txtbudgetB.text=txtbudgetB_tmp.text;			   GrdNature.SetGridText(2, 3,txtbudgetB.text); 			   txtNatureOfWork.text=txtNatureOfWork_tmp.text;			   //get data in grid master			   GrdNature.SetGridText(2, 0,txtNatureOfWork.text);			   			   txtNatureOfWork.text=GrdNature.GetGridData(2, 0); 			   txtMaincontractA.text=GrdNature.GetGridData(2, 1);			   txtMaincontractA_book.text=GrdNature.GetGridData(2, 2);			   txtbudgetB.text=GrdNature.GetGridData(2, 3); 			   txtbudgetB_book.text=GrdNature.GetGridData(2, 4);			   //txtB_Div_A.text=GrdNature.GetGridData(2, 5);			   txtDateFrom.text=GrdNature.GetGridData(2, 6);  			   txtDateTo.text=GrdNature.GetGridData(2, 7);			   				txtAdvancepayment.text="of contract price";				txtPerformanceGuaranty.text="of contract price";				txtPaymentTerm.text="progress payment";				txtRetention.text="of contract price"; 				txtDefectWarrantyPeriod.text="after the date issuing taking over certificate"; 				txtLiquidatedDamagesForDelay.text="of the contract price for each day of delay";										   		   }	}	if(obj=='Detail')	{		GrdContractMethod.AddRow();	}}var g_lag="";//---------------------------------------------------------------------    function OnSearch(idx) {	switch(idx)	{		case 0:				 if(txtMasterPK.text != '')					{						dso_search_master.Call();					}        break;    }}  function OnSave(){   if(GrdNature.rows==3)   {	   txtNatureOfWork.text=GrdNature.GetGridData(2, 0); 	   txtMaincontractA.text=GrdNature.GetGridData(2, 1);	   txtMaincontractA_book.text=GrdNature.GetGridData(2, 2);	   txtbudgetB.text=GrdNature.GetGridData(2, 3); 	   txtbudgetB_book.text=GrdNature.GetGridData(2, 4);	   //txtB_Div_A.text=GrdNature.GetGridData(2, 5);	   txtDateFrom.text=GrdNature.GetGridData(2, 6);  	   txtDateTo.text=GrdNature.GetGridData(2, 7);	}	if(dso_upd_master.GetStatus()==0 || dso_upd_master.GetStatus()==10||dso_upd_master.GetStatus()==40)	{		dso_upd_master.StatusUpdate();		dso_upd_master.Call();	}	else	{		dso_upd_master.Call();	}} function MerGrid(){	if (GrdNature.rows < 2)	{				GrdNature.AddRow();	}	var fg=GrdNature.GetGridControl();	fg.FixedRows = 2	fg.MergeCells = 5 	/*fg.MergeCol(0) = true	fg.Cell(0, 0, 0, 1, 0) = "PK"		fg.MergeCol(1) = true	fg.Cell(0, 0, 1, 1, 1) = "TECPS_ORDERINGCONTTYPE_PK"*/		fg.MergeCol(0) = true	fg.Cell(0, 0, 0, 1, 0) = "Nature of work" 	fg.MergeRow(0) = true	fg.Cell(0, 0, 1, 0, 5) = "Price"  	fg.Cell(0, 1, 1, 1) 	= "Main contract(A)"	fg.Cell(0, 1, 2, 1) 	= "Main contract(A) book"	fg.Cell(0, 1, 3, 1 ) 	= "Budget(B)"	fg.Cell(0, 1, 4, 1) 	= "Budget(B) book"	fg.Cell(0, 1, 5, 1) 	= "B/A"		fg.MergeRow(0) = true	fg.Cell(0, 0, 6, 0, 7) = "Contract period"  	fg.Cell(0, 1, 6, 1) 	= "From"	fg.Cell(0, 1, 7, 1 ) 	= "To"		}function OnDataReceive(obj){	if(dso_upd_master.GetStatus()==40|| dso_upd_master.GetStatus()==10|| dso_upd_master.GetStatus()==20)	{		if(dso_upd_master.GetStatus()==40 && txproject_Cd.GetData()=="")		{			GrdNature.ClearData();			Grid_Attach.ClearData();		}		else		{			GrdNature.SetGridText(2, 5,txtB_Div_A.text);//search again data-->refesh data again		}	}	if(obj.id=='dso_get_exrate')	{		dso_CheckExitData.Call();	}	if(obj.id=='dso_CheckExitData')	{		if(txtMasterPK.text != '')		{			OnSearch(0);		}		else		{			OnNew('Master');			OnSave();		}	}	if(obj.id=='dso_upd_master')	{		if(dso_upd_master.GetStatus()==10||dso_upd_master.GetStatus()==20||dso_upd_master.GetStatus()==40)		{			for(var i=1;i<GrdContractMethod.rows;i++)		   {				if(GrdContractMethod.GetGridData(i,1) == "")//tecps_subctrequest_pk				{					GrdContractMethod.SetGridText(i, 1,txtMasterPK.text);				}			}			dso_ContractMethod.Call();		}	}	if(obj.id=='dso_search_master')	{		if(dso_upd_master.GetStatus()==0)		{	       if(GrdNature.rows < 3)		   {			   GrdNature.AddRow(); 			   GrdNature.SetGridText(2, 0,txtNatureOfWork.text); 			   GrdNature.SetGridText(2, 1,txtMaincontractA.text);//tran			   GrdNature.SetGridText(2, 2,txtMaincontractA_book.text); //book			   GrdNature.SetGridText(2, 3,txtbudgetB.text); //tran			   GrdNature.SetGridText(2, 4,txtbudgetB_book.text);//book			   GrdNature.SetGridText(2, 5,txtB_Div_A.text);			   GrdNature.SetGridText(2, 6,txtDateFrom.text);  			   GrdNature.SetGridText(2, 7,txtDateTo.text);			}			dso_ContractMethod.Call("SELECT");		}		else		{		   for(var i=1;i<GrdContractMethod.rows;i++)		   {				if(GrdContractMethod.GetGridData(i,1) == "")//tecps_subctrequest_pk				{					GrdContractMethod.SetGridText(i, 1,txtMasterPK.text);				}			}			dso_ContractMethod.Call();		}			}	if(obj.id=='dso_ContractMethod')	{	   if(dso_upd_master.GetStatus()==0)	   {			DSO_ATTACH_FILE.Call("SELECT");		}	}	if(obj.id=='dso_get_exrate_list')	{			ChangBookAmt();		}	/*if(obj.id=='dso_get_exrate_list')	{			ChangBookAmt();		}*/	if(obj.id=='DSO_ATTACH_FILE')	{			txtAdvancepayment.text="of contract price";		txtPerformanceGuaranty.text="of contract price";		txtPaymentTerm.text="progress payment";		txtRetention.text="of contract price"; 		txtDefectWarrantyPeriod.text="after the date issuing taking over certificate"; 		txtLiquidatedDamagesForDelay.text="of the contract price for each day of delay";		}}function AttachFiles()    {            if(txtMasterPK.text != '')           {                     imgFile.MasterPK=txtMasterPK.text;                    imgFile.ChangeImage();					DSO_ATTACH_FILE.Call("SELECT");                    /*if( imgFile.oid == 1 )                    {						return false;                    }                    else                    {						//alert(imgFile.text);						Grid_Attach.SetGridText( Grid_Attach.rows - 1, 1, txtMasterPK.text);   		                        DSO_ATTACH_FILE.Call();                    }*/                    imgFile.oid= "";                 }         else        {               // alert('Please select the  Project first!!');        }     }function OnOpenFile(){        var img_pk = Grid_Attach.GetGridData(Grid_Attach.GetGridControl().row,0)	;        var url = System.RootURL + "/system/binary/viewfile.aspx?img_pk=" + img_pk + "&table_name=TECPS_SUBCTREQUESTD_FILE";	        window.open(url);}    //---------------------------------------------------------------------------------------------------------------------------------------------------------function onDelete(obj){	 if(obj=='Master')	 {		 if(confirm('Are you sure you want to delete ?'))		{			 dso_upd_master.StatusDelete();			 dso_upd_master.Call();		}	}	if(obj=='Detail')	 {		 if(GrdContractMethod.rows >1)		 {			 if(GrdContractMethod.row !="-1")			 {				if(confirm('Are you sure you want to delete ?'))				{					 GrdContractMethod.DeleteRow();					 dso_ContractMethod.Call();				}			 }		}	}	if(obj=='files')	 {		 if(confirm('Are you sure you want to delete selected file ?'))		{			 Grid_Attach.DeleteRow();			 DSO_ATTACH_FILE.Call();		}	}}function OnPopUp(pos)  {    switch(pos)        {        case 'Prepared_by':            var path = System.RootURL + '/form/ch/ae/chae00010_search_emp.aspx';            var obj = System.OpenModal( path ,800 , 600 ,  'resizable:yes;status:yes');             if ( obj != null )            {               txtPrepared.text = obj[2];               txtPrepared_PK.text   = obj[0];            }        break;  		case 'Reviewed_by':            var path = System.RootURL + '/form/ch/ae/chae00010_search_emp.aspx';            var obj = System.OpenModal( path ,800 , 600 ,  'resizable:yes;status:yes');             if ( obj != null )            {				txtReviewed.text = obj[2];                txtReviewed_PK.text   = obj[0];            }        break;		case 'Checked_by':            var path = System.RootURL + '/form/ch/ae/chae00010_search_emp.aspx';            var obj = System.OpenModal( path ,800 , 600 ,  'resizable:yes;status:yes');             if ( obj != null )            {				txtchecked.text = obj[2];                txtChecked_PK.text   = obj[0];            }        break;		case 'Approved_by':            var path = System.RootURL + '/form/ch/ae/chae00010_search_emp.aspx';            var obj = System.OpenModal( path ,800 , 600 ,  'resizable:yes;status:yes');             if ( obj != null )            {				txtApproved.text = obj[2];                txtApproved_PK.text   = obj[0];            }        break;		case 'Buspartner':				if(GrdContractMethod.col==4)			{  				var path = System.RootURL + '/form/61/05/61050020_popup2.aspx';					var obj = System.OpenModal( path ,800 , 600 , 'resizable:yes;status:yes');					if ( obj != null )					{						GrdContractMethod.SetGridText(GrdContractMethod.row, 3,obj[0]);//Buspartner pk						GrdContractMethod.SetGridText(GrdContractMethod.row, 4,obj[2]);//Buspartner name					}			}		break;	    }	       }function OnGetRate(){		dso_get_exrate_list.Call();	}function ChangBookAmt(){	var _MainContAmt = Number(GrdNature.GetGridData(2, 1));//amt A 	var _BudgetAmt = Number(GrdNature.GetGridData(2, 3)); //budget Amt B 		//alert(_Amount)	;		//txtTotal.text=_Amount;			var ccy = lstccy.GetData();		var tr_rate = Number(txtTR_RATE.text);		txtccy.value = lstccy.GetData();		var _Bk_MainContAmt = 0,_Bk_BudgetAmt = 0;		var _book_rate = Number(txtBookRate.GetData());		//alert(txtBookRate.GetData());		if(txtbookccy.text == 'VND' && _book_rate > 0)		{				if(ccy == 'USD')				{						_Bk_MainContAmt =	Math.round(_MainContAmt * tr_rate)						_Bk_BudgetAmt =	Math.round(_BudgetAmt * tr_rate)				}				else if(ccy == 'VND')				{						_Bk_MainContAmt = Math.round(_Amount / _book_rate );						_Bk_BudgetAmt = Math.round(_Amount / _book_rate );				}		}		else if(txtbookccy.text == 'USD' && _book_rate > 0)		{				if(ccy == 'USD')				{						_Bk_MainContAmt = Math.round((_Amount * _book_rate / _book_rate) * 100) / 100;						_Bk_BudgetAmt = Math.round((_Amount * _book_rate / _book_rate) * 100) / 100;				}				else if(ccy == 'VND')				{						_Bk_MainContAmt = Math.round(_Amount / _book_rate *100 )/100;						_Bk_BudgetAmt = Math.round(_Amount / _book_rate *100 )/100;				}		}			txtMaincontractA_book.text=_Bk_MainContAmt;		txtbudgetB_book.text=_Bk_BudgetAmt;}function BookAmt(){	OnGetRate();				}function OnPrint(){	if(txtMasterPK.text !="")	{   		var url = '/reports/61/05/rpt_61050050_subcontract_req.aspx?p_MasterPK='+txtMasterPK.text+"&p_ccy="+lstccy.text;			System.OpenTargetPage( System.RootURL+url , "newform" );			window.close();	}}//--------------------------------------------------------------</script><body><!------------------------------------------><gw:data id="dso_CheckExitData" onreceive="OnDataReceive(this)">        <xml>             <dso type="process" procedure="sp_sel_kpcs311_data_exit">                 <input>                      <input bind="txtTecps_Orderingconttype_pk"/>                </input>                <output>                <out bind="txtMasterPK"/>               </output>             </dso>         </xml>     </gw:data><!-------------------------------------------------------------------------------------------------------><gw:data id="dso_search_master" onreceive="OnDataReceive(this)">        <xml>             <dso type="process" procedure="sp_sel_kpcs311_subcont_req_m">                 <input>                      <input bind="txtTecps_Orderingconttype_pk"/>                </input>                <output>                <out bind="txtMasterPK"/>                <out bind="txproject_Cd"/>                <out bind="txtxproject_Nm"/>                <out bind="txproject_Pk"/>                <out bind="txtServiceType"/>                    <out bind="dtFromDateM"/>                <out bind="txtRedNo"/>                <out bind="txtPrepared"/>                <out bind="txtPrepared_PK"/>                <out bind="txtReviewed"/>                                        <out bind="txtReviewed_PK"/>                <out bind="txtchecked"/>                <out bind="txtChecked_PK"/>                <out bind="txtApproved"/>                <out bind="txtApproved_PK"/>								<out bind="txtNatureOfWork"/>                <out bind="txtMaincontractA"/>				<out bind="txtMaincontractA_book"/>                <out bind="txtbudgetB"/>				<out bind="txtbudgetB_book"/>                <out bind="txtB_Div_A"/>                <out bind="txtDateFrom"/>				<out bind="txtDateTo"/>     								<out bind="txtAdvancepayment"/>                <out bind="txtPerformanceGuaranty"/>                <out bind="txtPaymentTerm"/>                <out bind="txtRetention"/>                <out bind="txtDefectWarrantyPeriod"/>				<out bind="txtLiquidatedDamagesForDelay"/>				<out bind="txtTecps_Orderingconttype_pk"/>								<inout bind="txtAdvancepaymentRate"/>                <inout bind="txtPerformanceGuarantyRate"/>                <inout bind="txtPaymentTermRate"/>                <inout bind="txtRetentionRate"/>                <inout bind="txtDefectWarrantyPeriodRate"/>				<inout bind="txtLiquidatedDamagesForDelayRate"/>               </output>             </dso>         </xml>     </gw:data>	<!--------------------------------------------->   <gw:data id="dso_upd_master" onreceive="OnDataReceive(this)">        <xml>             <dso type="control" parameter="0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35" function="sp_sel_kpcs311_subcont_request" procedure = "sp_upd_kpcs311_subcont_request">               <inout> 	                   <inout bind="txtMasterPK"/>                <inout bind="txproject_Cd"/>                <inout bind="txtxproject_Nm"/>                <inout bind="txproject_Pk"/>                <inout bind="txtServiceType"/>                    <inout bind="dtFromDateM"/>                <inout bind="txtRedNo"/>                <inout bind="txtPrepared"/>                <inout bind="txtPrepared_PK"/>                <inout bind="txtReviewed"/>                                        <inout bind="txtReviewed_PK"/>                <inout bind="txtchecked"/>                <inout bind="txtChecked_PK"/>                <inout bind="txtApproved"/>                <inout bind="txtApproved_PK"/>								<inout bind="txtNatureOfWork"/>                <inout bind="txtMaincontractA"/>				<inout bind="txtMaincontractA_book"/>                 <inout bind="txtbudgetB"/>				<inout bind="txtbudgetB_book"/>                <inout bind="txtB_Div_A"/>                <inout bind="txtDateFrom"/>				<inout bind="txtDateTo"/>     								<inout bind="txtAdvancepayment"/>                <inout bind="txtPerformanceGuaranty"/>                <inout bind="txtPaymentTerm"/>                <inout bind="txtRetention"/>                <inout bind="txtDefectWarrantyPeriod"/>				<inout bind="txtLiquidatedDamagesForDelay"/>				<inout bind="txtTecps_Orderingconttype_pk"/>								<inout bind="txtAdvancepaymentRate"/>                   <inout bind="txtPerformanceGuarantyRate"/>                <inout bind="txtPaymentTermRate"/>                <inout bind="txtRetentionRate"/>                <inout bind="txtDefectWarrantyPeriodRate"/>				<inout bind="txtLiquidatedDamagesForDelayRate"/>              </inout>                          </dso>         </xml>     </gw:data><!-------------------------------------------------------------------><gw:data id="dso_ContractMethod" onreceive="OnDataReceive(this)">    <xml>        <dso id="1" type="grid" parameter="0,1,2,3,4,5,6,7" function="sp_sel_kpcs311_contract_dtl" procedure="sp_upd_kpcs311_contract_dtl">            <input bind="GrdContractMethod" >                <input bind="txtMasterPK" />            </input>            <output bind="GrdContractMethod" />        </dso>    </xml></gw:data><!------------------------------------------------------------------------------------------------------------------>    <gw:data id="DSO_ATTACH_FILE" onreceive="OnDataReceive(this)">  <xml>    <dso id="1" type="grid" parameter="0"  function="sp_sel_kpcs311_file"  procedure="sp_upd_kpcs311_file">      <input bind="Grid_Attach" >      <input bind="txtMasterPK" />      </input>      <output bind="Grid_Attach" />    </dso>  </xml></gw:data><!------------------------------------------------><gw:data id="dso_get_exrate" onreceive="OnDataReceive(this)">        <xml>             <dso type="process" procedure="sp_pro_get_rate">                 <input>                 	 <input bind="txtUSE_DATE" />                     <input bind="lstCOMPANY"/>                     <input bind="txtbookccy" />                     <input bind="txt_row"/>                </input>                <output>                     <output bind="txtBookRate"/>                     <output bind="txt_row"/>               </output>             </dso>         </xml> </gw:data>	<!-------------------------------------------------------------------><gw:data id="dso_get_exrate_list" onreceive="OnDataReceive(this)">        <xml>             <dso type="process" procedure="sp_61050010_get_rate" >                  <input>                      <input bind="lstCOMPANY"/>                     <input bind="txtccy"/>                     <input bind="txtUSE_DATE"/>                </input>                <output>                     <output bind="txtTR_RATE"/>                     <output bind="txtBK_RATE"/>					 <output bind="txtbookccy"/>               </output>             </dso>         </xml> </gw:data><!---------------------------------------><table style="width:100%;height:100%" cellpadding="0" cellspacing="0">	<tr style="height:10%">	  <td > 		  <table cellpadding="0" cellspacing="2" width="100%" >		    <tr>				<td style="width:10%"></td>				<td style="width:14%"></td>				<td style="width:5%"></td>				<td style="width:3%"></td>								<td style="width:8%"></td>								<td style="width:7%"></td>				<td style="width:7%"></td>				<td style="width:10%"></td>				<td style="width:3%"></td>								<td style="width:8%"></td>								<td style="width:3%"></td>				<td style="width:7%"></td>				<td style="width:3%"></td>				<td style="width:3%"></td>				<td style="width:3%"></td>				<td style="width:3%"></td>				<td style="width:3%"></td>			</tr>			<tr>			   <td align="right"><a title="Click here to show project" href="#" style="text-decoration:none" onclick="OnPopUp('project');">Project&nbsp;</a></td>                <td colspan="9"><gw:textbox id="txproject_Cd" readonly="true" styles='width:35%' /><gw:textbox id="txtxproject_Nm" readonly="true" styles='width:64%' /></td>			   <td ><gw:imgbtn id="btjv2" img="reset" alt="Reset"  onclick="txproject_Pk.text='';txproject_Cd.text='';txtxproject_Nm.text='';" /></td>			   <td style="width:3%"></td> 			   <td align="right"><gw:imgbtn id="btnSearchM" img="search" alt="Inquiry"  onclick="OnSearch(0)" /></td> 			   <td align="right"><gw:imgbtn id="btnAddNewM" img="new" alt="Increase version"  onclick="OnNew('Master')" /></td>			   <td align="right"><gw:imgbtn id="btDeleteM" img="delete" alt="Delete All"  onclick="onDelete('Master')" /></td>			   <td align="right"><gw:imgbtn id="btSaveM" img="save" alt="Save"  onclick="OnSave()" /></td> 			   <td width="3%"><gw:imgbtn img="excel" alt="Print" text="Print" id="btnReport" onclick="OnPrint()" /></td>			   			 </tr>			  <tr>				<td style="width:8%" align="right">Service Type</td>				<td style="width:17%"colspan="5"><gw:textbox id="txtServiceType" readonly="true" styles='width:100%' /></td>				<td></td>				<td style="width:8%" align="right"  >Date&nbsp;</td>				<td style="width:9%" colspan="2"><gw:datebox id="dtFromDateM" lang="1" styles='width:100%;' onchange="" /></td>				<td style="width:8%" align="right">Req.No&nbsp;</td>  				<td style="width:9%" colspan="6"><gw:textbox id="txtRedNo"  styles='width:100%' /></td>			</tr>			<tr>			   <td align="right"><a title="Click here to Prepared by" href="#" style="text-decoration:none" onclick="OnPopUp('Prepared_by');">Prepared by&nbsp;</a></td>                <td colspan="5"><gw:textbox id="txtPrepared"  styles='width:100%' /></td> 			   <td ><gw:imgbtn id="btPrepared" img="reset" alt="Reset"  onclick="txtPrepared.text='';txtPrepared_PK.text='';" /></td>			   <td align="right"><a title="Click here to Reviewed by" href="#" style="text-decoration:none" onclick="OnPopUp('Reviewed_by');">Reviewed by&nbsp;</a></td> 			  <td colspan="11"><gw:textbox id="txtReviewed"  styles='width:100%' /></td>			   <td ><gw:imgbtn id="btPrepared" img="reset" alt="Reset"  onclick="txtReviewed.text='';txtReviewed_PK.text='';" /></td>			 </tr>			 <tr> 			   <td align="right"><a title="Click here to Checked by" href="#" style="text-decoration:none" onclick="OnPopUp('Checked_by');">Checked by&nbsp;</a></td>                <td colspan="5"><gw:textbox id="txtchecked" styles='width:100%' /></td>			   <td ><gw:imgbtn id="btchecked" img="reset" alt="Reset"  onclick="txtchecked.text='';txtChecked_PK.text='';" /></td>			   <td align="right"><a title="Click here to Approved by" href="#" style="text-decoration:none" onclick="OnPopUp('Approved_by');">Approved by&nbsp;</a></td> 			  <td colspan="11"><gw:textbox id="txtApproved" styles='width:100%' /></td>			   <td ><gw:imgbtn id="btjv2" img="reset" alt="Reset"  onclick="txtApproved.text='';txtApproved_PK.text='';" /></td>			 </tr>			</table> 				  </td>  	</tr>	<tr styles="width:100%; height:15%"> 		<td colspan="17">		<fieldset style="padding: 2">		<legend style="color: Red">Nature of work and budget</legend>			<table style="width:100%;height:100%">				<tr>					<td colspan="17">						<gw:grid   							id="GrdNature"  							header="1|2|_3|4|_5|6|7|8"   							format  ="0|-0|-0|-0|-0|-0|4|4"  							aligns  ="0|0|0|0|0|0|0|0"  							defaults="|||||||"  							editcol ="1|1|1|0|1|0|1|1"  							widths  ="4000|2300|2300|2300|2300|2300|1300|1300"  							styles="width:100%; height:80"   							sorting="T"   							acceptNullDate="T" onafteredit="BookAmt()"						 /> 				</td>				</tr>			</table>		</fieldset>		</td>	</tr>		<tr styles="width:100%; height:2%">		<td colspan="17">		<fieldset style="padding: 5"> 		<legend style="color: Red">Contract method and nominated company</legend>			<table style="width:100%;height:100%">				<tr>					<td colspan="17">						<table style="width:100%;height:100%">							<tr>								<td width="94%"></td>									<td width="3%"><gw:imgbtn id="btnadNewDtl" img="new" alt="Increase version"  onclick="OnNew('Detail')" /></td>									<td width="3%"><gw:imgbtn id="btDeletedtl" img="delete" alt="Delete All"  onclick="onDelete('Detail')" /></td>							</tr>						</table>						</td>									</tr>				<tr >	    <!--0_pk|1.Trs. Currency|2.Main Contract Amount|3.Ex Rate|4.EX Rate Date|5.Book Currency|6.Booking Amount|7.Exrate book-->					<td colspan="17">						<gw:grid   							id="GrdContractMethod"  							header="_pk|_tecps_subctrequest_pk|Contract Method|_TCO_BUSPARTNER_PK|Company Name|Contract Person|Telephone No|Description"   							format  ="0|0|0|0|0|0|0|0"  							aligns  ="0|0|0|0|0|0|0|0"  							defaults="||||||||"  							editcol ="1|1|1|1|1|1|1|1"  							widths  ="1500|2000|3000|1200|1500|3000|1000|1000"  							styles="width:100%; height:150"   							sorting="T" 							autosize="T" oncelldblclick="OnPopUp('Buspartner')"						 /> 					</td>				</tr> 			</table>		</fieldset>		</td> 	</tr>	<tr styles="width:100%; height:12%">		<td colspan="17">		<fieldset style="padding: 5">			<legend style="color: Red">&nbsp;Terms of conditions&nbsp;&nbsp;&nbsp;</legend>			<table style="width:100%;height:100%">				<tr style="height:18%">					<td width="30%">Advance payment</td>					<td width="35%"><gw:textbox id="txtAdvancepaymentRate" type="number" format="###,###,###" styles="text-align:right;width:90%;"  /><gw:label id="txtCount1" text="%" styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtAdvancepayment" styles="width:100%;"  /></td>				</tr>				<tr style="height:17%">					<td width="30%">Performance Guaranty</td>					<td width="35%"><gw:textbox id="txtPerformanceGuarantyRate" type="number" format="###,###,###" styles="text-align:right;width:90%;"  /><gw:label id="txtCount2" text="%" styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtPerformanceGuaranty"   /></td>				</tr>				<tr style="height:17%"> 					<td width="30%">Payment Term</td>					<td width="35%"><gw:textbox id="txtPaymentTermRate" styles="width:90%;"  /><gw:label id="txtCount3" text=" " styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtPaymentTerm"  styles='width:100%' /></td>				</tr>				<tr style="height:17%">					<td width="30%">Retention</td>					<td width="35%"><gw:textbox id="txtRetentionRate" type="number" format="###,###,###" styles="text-align:right;width:90%;"  /><gw:label id="txtCount4" text="%" styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtRetention" /></td>				</tr>				<tr style="height:17%">					<td width="30%">Defect Warranty Period</td>					<td width="35%"><gw:textbox id="txtDefectWarrantyPeriodRate"  styles="width:90%;"  /><gw:label id="txtCount5" text=" " styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtDefectWarrantyPeriod"  styles='width:100%' /></td>				</tr>				<tr style="height:17%">					<td width="30%">Liquidated Damages For Delay</td>					<td width="35%"><gw:textbox id="txtLiquidatedDamagesForDelayRate" type="number" format="###,###,###" styles="text-align:right;width:90%;"  /><gw:label id="txtCount6" text="%" styles="text-align:center;width:9%;font:bold;" /></td>					<td width="35%"><gw:textbox id="txtLiquidatedDamagesForDelay" /></td>				</tr>			</table>		</fieldset>		</td>	</tr>	<tr styles="width:100%; height:2%">		<td colspan="17">		<fieldset style="padding: 5"> 		<legend style="color: Red">Attached File</legend>			<table style="width:100%;height:100%">				<tr>					<td colspan="17">						<table style="width:100%;height:100%">							<tr>								<td width="94%"></td>									<td width="3%"><gw:imgbtn id="btS" img="attach" alt="Attach file"  onclick="AttachFiles()" /></td>									<td width="3%"><gw:imgbtn id="btDeletedtl" img="delete" alt="Delete All"  onclick="onDelete('files')" /></td>									<td style="display:none"><gw:datebox id="txtUSE_DATE" lang="1" styles='width:100%;display:none' /></td>							</tr>						</table>						</td>									</tr>				<tr >	    <!--0_pk|1.Trs. Currency|2.Main Contract Amount|3.Ex Rate|4.EX Rate Date|5.Book Currency|6.Booking Amount|7.Exrate book-->					<td colspan="17">						<gw:grid   							id="Grid_Attach"  							header="_pk|_tecps_subctrequest_pk|Entry Date|File Name|Description"   							format  ="0|0|0|0|0"  							aligns  ="0|0|0|0|0"  							defaults="||||"  							editcol ="0|0|0|0|0"  							widths  ="3000|1500|1500|900|1500"  							autosize="T"							styles="width:100%; height:80"   							sorting="T" oncelldblclick="OnOpenFile()"   						 /> 					</td>				</tr> 			</table>		</fieldset>		</td> 	</tr></table>   <!--------------------------------------------------------------------------->    <gw:textbox id="txt_tps_prjconversion_pk" styles='display:none;width:100%' />	<gw:textbox id="txproject_Pk" styles='width:100%;display:none' />	<gw:textbox id="txproject_Cd_tmp" styles='width:100%;display:none' />	<gw:textbox id="txtxproject_Nm_tmp" styles='width:100%;display:none' />	<gw:textbox id="txproject_Pk_tmp" styles='width:100%;display:none' />	<gw:textbox id="txtServiceType_tmp" styles='width:100%;display:none' />	<gw:textbox id="txtRedNo_tmp" styles='width:100%;display:none' />	  	<gw:textbox id="txtPrepared_PK" styles='width:100%;display:none' />	<gw:textbox id="txtReviewed_PK" styles='width:100%;display:none' />	<gw:textbox id="txtChecked_PK" styles='width:100%;display:none' />	<gw:textbox id="txtApproved_PK" styles='width:100%;display:none' /> 	<gw:textbox id="txtMasterPK" styles='width:100%;display:none' />	<gw:textbox id="txtTecps_Orderingconttype_pk" styles='width:100%;display:none' />	<gw:textbox id="txtTecps_Orderingconttype_pk_tmp" styles='width:100%;display:none' />	<gw:textbox id="txtNatureOfWork" styles='width:100%;display:none' />	<gw:textbox id="txtMaincontractA" styles='width:100%;display:none' />	<gw:textbox id="txtbudgetB" styles='width:100%;display:none' />	<gw:textbox id="txtMaincontractA_book" styles='width:100%;display:none' />	<gw:textbox id="txtbudgetB_book" styles='width:100%;display:none' />	<gw:textbox id="txtB_Div_A" styles='width:100%;display:none' />	<gw:textbox id="txtDateFrom" styles='width:100%;display:none' />	<gw:textbox id="txtDateTo" styles='width:100%;display:none' />	<gw:textbox id="txtbudgetB_tmp" styles='width:100%;display:none' />	<gw:textbox id="txtNatureOfWork_tmp" styles='width:100%;display:none' />	<gw:list id="lstCOMPANY" styles='width:100%;display:none' />	 <gw:textbox id="txtbookccy" styles='width:100%;display:none' />	 <gw:textbox id="txt_row" styles='display:none' />	 <gw:textbox id="txtBookRate" styles='width:100%;display:none' />	 <gw:list id="txtccy" onchange="OnGetRate()" styles='width:100%;display:none' />	 <gw:textbox id="txtBK_RATE"  styles='width:100%;display:none' />	 <gw:textbox id="txtTR_RATE" styles="width:100%;display:none" />	 <gw:textbox id="txtTotalBookAmt" styles="width:100%;display:none" /> 	 <gw:textbox id="lstccy" styles="width:100%;display:none" />	<gw:image id="imgFile" table_name="tecps_subctrequestd_file" procedure="sp_upd_kpcs311_all_file" view="/binary/ViewFile.aspx"        post="/binary/PostFile.aspx" styles="width:100;height:100;display:none" />    <!---------------------------------------------------------------------------></body></html>